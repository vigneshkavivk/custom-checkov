metadata:
  name: "RDS Instances Should Not Be Publicly Accessible"
  id: "MASA_TF_012"
  category: "networking"
  severity: "HIGH"
  description: |
    Ensures RDS instances are not publicly accessible over the internet.
  rationale: |
    Public RDS access can expose databases to unauthorized access and attacks.
  impact: |
    Publicly accessible RDS instances pose serious security risks.
  remediation: |
    Set publicly_accessible = false in the resource configuration.
  references:
    - https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/Overview.DBInstance.html

definition:
  cond_type: "and"
  conditions:
    - cond_type: "attribute"
      resource_types: ["aws_db_instance"]
      attribute: "publicly_accessible"
      operator: "exists"
      value: true
    - cond_type: "attribute"
      resource_types: ["aws_db_instance"]
      attribute: "publicly_accessible"
      operator: "equals"
      value: false
